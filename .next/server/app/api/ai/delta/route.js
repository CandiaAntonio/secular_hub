"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai/delta/route";
exports.ids = ["app/api/ai/delta/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fdelta%2Froute&page=%2Fapi%2Fai%2Fdelta%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fdelta%2Froute.ts&appDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fdelta%2Froute&page=%2Fapi%2Fai%2Fdelta%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fdelta%2Froute.ts&appDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_1_Projects_secular_forum_secular_hub_app_api_ai_delta_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ai/delta/route.ts */ \"(rsc)/./app/api/ai/delta/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai/delta/route\",\n        pathname: \"/api/ai/delta\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai/delta/route\"\n    },\n    resolvedPagePath: \"C:\\\\1 Projects\\\\secular_forum\\\\secular_hub\\\\app\\\\api\\\\ai\\\\delta\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_1_Projects_secular_forum_secular_hub_app_api_ai_delta_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ai/delta/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhaSUyRmRlbHRhJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhaSUyRmRlbHRhJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYWklMkZkZWx0YSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDMSUyMFByb2plY3RzJTVDc2VjdWxhcl9mb3J1bSU1Q3NlY3VsYXJfaHViJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDMSUyMFByb2plY3RzJTVDc2VjdWxhcl9mb3J1bSU1Q3NlY3VsYXJfaHViJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN5QjtBQUN0RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NlY3VsYXJfaHViLz9hYzE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXDEgUHJvamVjdHNcXFxcc2VjdWxhcl9mb3J1bVxcXFxzZWN1bGFyX2h1YlxcXFxhcHBcXFxcYXBpXFxcXGFpXFxcXGRlbHRhXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9haS9kZWx0YS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FpL2RlbHRhXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9haS9kZWx0YS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXDEgUHJvamVjdHNcXFxcc2VjdWxhcl9mb3J1bVxcXFxzZWN1bGFyX2h1YlxcXFxhcHBcXFxcYXBpXFxcXGFpXFxcXGRlbHRhXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9haS9kZWx0YS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fdelta%2Froute&page=%2Fapi%2Fai%2Fdelta%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fdelta%2Froute.ts&appDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ai/delta/route.ts":
/*!***********************************!*\
  !*** ./app/api/ai/delta/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db_queries__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db/queries */ \"(rsc)/./lib/db/queries.ts\");\n/* harmony import */ var _lib_ai_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/ai/client */ \"(rsc)/./lib/ai/client.ts\");\n/* harmony import */ var _lib_ai_prompts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/ai/prompts */ \"(rsc)/./lib/ai/prompts.ts\");\n/* harmony import */ var _lib_ai_parsers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/ai/parsers */ \"(rsc)/./lib/ai/parsers.ts\");\n/* harmony import */ var _lib_ai_cache__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/ai/cache */ \"(rsc)/./lib/ai/cache.ts\");\n\n\n\n\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { year1, year2, theme_category } = body;\n        if (!year1 || !year2) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Both year1 and year2 are required\"\n            }, {\n                status: 400\n            });\n        }\n        const cacheKey = (0,_lib_ai_cache__WEBPACK_IMPORTED_MODULE_5__.generateCacheKey)(\"delta-narrative\", {\n            year1,\n            year2,\n            theme_category\n        });\n        const cachedResult = (0,_lib_ai_cache__WEBPACK_IMPORTED_MODULE_5__.getCached)(cacheKey);\n        if (cachedResult) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(cachedResult);\n        // Fetch comparison stats\n        const stats = await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_1__.getCompareStats)(year1, year2);\n        // Format stats for prompt\n        const emerged = stats.themes_emerged.slice(0, 10).join(\", \");\n        const extinct = stats.themes_extinct.slice(0, 10).join(\", \");\n        const grew = stats.themes_grew.slice(0, 5).map((t)=>`${t.theme} (+${t.delta})`).join(\", \");\n        const declined = stats.themes_declined.slice(0, 5).map((t)=>`${t.theme} (${t.delta})`).join(\", \");\n        // We also need \"top themes\" for context, which getCompareStats doesn't fully give in a simple list\n        // We can infer them from grew/declined or fetch separately. \n        // For simplicity, we'll use the grew/declined lists as proxies for active themes.\n        const year1_themes = stats.themes_declined.map((t)=>t.theme).slice(0, 10).join(\", \");\n        const year2_themes = stats.themes_grew.map((t)=>t.theme).slice(0, 10).join(\", \");\n        const promptText = await (0,_lib_ai_prompts__WEBPACK_IMPORTED_MODULE_3__.loadPrompt)(\"delta-narrative\", {\n            year1,\n            year2,\n            year1_themes,\n            year2_themes,\n            emerged,\n            extinct,\n            increased: grew,\n            decreased: declined\n        });\n        const completion = await (0,_lib_ai_client__WEBPACK_IMPORTED_MODULE_2__.getCompletion)([\n            {\n                role: \"system\",\n                content: \"You are a market strategist.\"\n            },\n            {\n                role: \"user\",\n                content: promptText\n            }\n        ], {\n            temperature: 0.4\n        });\n        const result = (0,_lib_ai_parsers__WEBPACK_IMPORTED_MODULE_4__.parseAiResponse)(completion, _lib_ai_parsers__WEBPACK_IMPORTED_MODULE_4__.DeltaNarrativeSchema);\n        (0,_lib_ai_cache__WEBPACK_IMPORTED_MODULE_5__.setCached)(cacheKey, result);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZWx0YS9yb3V0ZS50cz82NWI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgZ2V0Q29tcGFyZVN0YXRzIH0gZnJvbSAnQC9saWIvZGIvcXVlcmllcyc7XHJcbmltcG9ydCB7IGdldENvbXBsZXRpb24gfSBmcm9tICdAL2xpYi9haS9jbGllbnQnO1xyXG5pbXBvcnQgeyBsb2FkUHJvbXB0IH0gZnJvbSAnQC9saWIvYWkvcHJvbXB0cyc7XHJcbmltcG9ydCB7IHBhcnNlQWlSZXNwb25zZSwgRGVsdGFOYXJyYXRpdmVTY2hlbWEgfSBmcm9tICdAL2xpYi9haS9wYXJzZXJzJztcclxuaW1wb3J0IHsgZ2V0Q2FjaGVkLCBzZXRDYWNoZWQsIGdlbmVyYXRlQ2FjaGVLZXkgfSBmcm9tICdAL2xpYi9haS9jYWNoZSc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuICAgIGNvbnN0IHsgeWVhcjEsIHllYXIyLCB0aGVtZV9jYXRlZ29yeSB9ID0gYm9keTtcclxuXHJcbiAgICBpZiAoIXllYXIxIHx8ICF5ZWFyMikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0JvdGggeWVhcjEgYW5kIHllYXIyIGFyZSByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjYWNoZUtleSA9IGdlbmVyYXRlQ2FjaGVLZXkoJ2RlbHRhLW5hcnJhdGl2ZScsIHsgeWVhcjEsIHllYXIyLCB0aGVtZV9jYXRlZ29yeSB9KTtcclxuICAgIGNvbnN0IGNhY2hlZFJlc3VsdCA9IGdldENhY2hlZChjYWNoZUtleSk7XHJcbiAgICBpZiAoY2FjaGVkUmVzdWx0KSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FjaGVkUmVzdWx0KTtcclxuXHJcbiAgICAvLyBGZXRjaCBjb21wYXJpc29uIHN0YXRzXHJcbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGdldENvbXBhcmVTdGF0cyh5ZWFyMSwgeWVhcjIpO1xyXG4gICAgXHJcbiAgICAvLyBGb3JtYXQgc3RhdHMgZm9yIHByb21wdFxyXG4gICAgY29uc3QgZW1lcmdlZCA9IHN0YXRzLnRoZW1lc19lbWVyZ2VkLnNsaWNlKDAsIDEwKS5qb2luKCcsICcpO1xyXG4gICAgY29uc3QgZXh0aW5jdCA9IHN0YXRzLnRoZW1lc19leHRpbmN0LnNsaWNlKDAsIDEwKS5qb2luKCcsICcpO1xyXG4gICAgY29uc3QgZ3JldyA9IHN0YXRzLnRoZW1lc19ncmV3LnNsaWNlKDAsIDUpLm1hcCh0ID0+IGAke3QudGhlbWV9ICgrJHt0LmRlbHRhfSlgKS5qb2luKCcsICcpO1xyXG4gICAgY29uc3QgZGVjbGluZWQgPSBzdGF0cy50aGVtZXNfZGVjbGluZWQuc2xpY2UoMCwgNSkubWFwKHQgPT4gYCR7dC50aGVtZX0gKCR7dC5kZWx0YX0pYCkuam9pbignLCAnKTtcclxuXHJcbiAgICAvLyBXZSBhbHNvIG5lZWQgXCJ0b3AgdGhlbWVzXCIgZm9yIGNvbnRleHQsIHdoaWNoIGdldENvbXBhcmVTdGF0cyBkb2Vzbid0IGZ1bGx5IGdpdmUgaW4gYSBzaW1wbGUgbGlzdFxyXG4gICAgLy8gV2UgY2FuIGluZmVyIHRoZW0gZnJvbSBncmV3L2RlY2xpbmVkIG9yIGZldGNoIHNlcGFyYXRlbHkuIFxyXG4gICAgLy8gRm9yIHNpbXBsaWNpdHksIHdlJ2xsIHVzZSB0aGUgZ3Jldy9kZWNsaW5lZCBsaXN0cyBhcyBwcm94aWVzIGZvciBhY3RpdmUgdGhlbWVzLlxyXG4gICAgY29uc3QgeWVhcjFfdGhlbWVzID0gc3RhdHMudGhlbWVzX2RlY2xpbmVkLm1hcCh0ID0+IHQudGhlbWUpLnNsaWNlKDAsIDEwKS5qb2luKCcsICcpO1xyXG4gICAgY29uc3QgeWVhcjJfdGhlbWVzID0gc3RhdHMudGhlbWVzX2dyZXcubWFwKHQgPT4gdC50aGVtZSkuc2xpY2UoMCwgMTApLmpvaW4oJywgJyk7XHJcblxyXG5cclxuICAgIGNvbnN0IHByb21wdFRleHQgPSBhd2FpdCBsb2FkUHJvbXB0KCdkZWx0YS1uYXJyYXRpdmUnLCB7XHJcbiAgICAgIHllYXIxLFxyXG4gICAgICB5ZWFyMixcclxuICAgICAgeWVhcjFfdGhlbWVzLFxyXG4gICAgICB5ZWFyMl90aGVtZXMsXHJcbiAgICAgIGVtZXJnZWQsXHJcbiAgICAgIGV4dGluY3QsXHJcbiAgICAgIGluY3JlYXNlZDogZ3JldyxcclxuICAgICAgZGVjcmVhc2VkOiBkZWNsaW5lZCxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBnZXRDb21wbGV0aW9uKFtcclxuICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogJ1lvdSBhcmUgYSBtYXJrZXQgc3RyYXRlZ2lzdC4nIH0sXHJcbiAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHRUZXh0IH1cclxuICAgIF0sIHsgdGVtcGVyYXR1cmU6IDAuNCB9KTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBwYXJzZUFpUmVzcG9uc2UoY29tcGxldGlvbiwgRGVsdGFOYXJyYXRpdmVTY2hlbWEpO1xyXG5cclxuICAgIHNldENhY2hlZChjYWNoZUtleSwgcmVzdWx0KTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldENvbXBhcmVTdGF0cyIsImdldENvbXBsZXRpb24iLCJsb2FkUHJvbXB0IiwicGFyc2VBaVJlc3BvbnNlIiwiRGVsdGFOYXJyYXRpdmVTY2hlbWEiLCJnZXRDYWNoZWQiLCJzZXRDYWNoZWQiLCJnZW5lcmF0ZUNhY2hlS2V5IiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsInllYXIxIiwieWVhcjIiLCJ0aGVtZV9jYXRlZ29yeSIsImVycm9yIiwic3RhdHVzIiwiY2FjaGVLZXkiLCJjYWNoZWRSZXN1bHQiLCJzdGF0cyIsImVtZXJnZWQiLCJ0aGVtZXNfZW1lcmdlZCIsInNsaWNlIiwiam9pbiIsImV4dGluY3QiLCJ0aGVtZXNfZXh0aW5jdCIsImdyZXciLCJ0aGVtZXNfZ3JldyIsIm1hcCIsInQiLCJ0aGVtZSIsImRlbHRhIiwiZGVjbGluZWQiLCJ0aGVtZXNfZGVjbGluZWQiLCJ5ZWFyMV90aGVtZXMiLCJ5ZWFyMl90aGVtZXMiLCJwcm9tcHRUZXh0IiwiaW5jcmVhc2VkIiwiZGVjcmVhc2VkIiwiY29tcGxldGlvbiIsInJvbGUiLCJjb250ZW50IiwidGVtcGVyYXR1cmUiLCJyZXN1bHQiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ai/delta/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/cache.ts":
/*!*************************!*\
  !*** ./lib/ai/cache.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateCacheKey: () => (/* binding */ generateCacheKey),\n/* harmony export */   getCached: () => (/* binding */ getCached),\n/* harmony export */   setCached: () => (/* binding */ setCached)\n/* harmony export */ });\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lru-cache */ \"(rsc)/./node_modules/lru-cache/dist/esm/index.js\");\n\nconst options = {\n    max: 100,\n    ttl: 1000 * 60 * 60,\n    allowStale: false\n};\nconst cache = new lru_cache__WEBPACK_IMPORTED_MODULE_0__.LRUCache(options);\nfunction getCached(key) {\n    return cache.get(key);\n}\nfunction setCached(key, value, ttl) {\n    cache.set(key, value, {\n        ttl\n    });\n}\nfunction generateCacheKey(prefix, params) {\n    const sortedKeys = Object.keys(params).sort();\n    const paramString = sortedKeys.map((key)=>`${key}:${JSON.stringify(params[key])}`).join(\"|\");\n    return `${prefix}|${paramString}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvY2FjaGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFxQztBQUVyQyxNQUFNQyxVQUFVO0lBQ2RDLEtBQUs7SUFDTEMsS0FBSyxPQUFPLEtBQUs7SUFDakJDLFlBQVk7QUFDZDtBQUVBLE1BQU1DLFFBQVEsSUFBSUwsK0NBQVFBLENBQWNDO0FBRWpDLFNBQVNLLFVBQWFDLEdBQVc7SUFDdEMsT0FBT0YsTUFBTUcsR0FBRyxDQUFDRDtBQUNuQjtBQUVPLFNBQVNFLFVBQVVGLEdBQVcsRUFBRUcsS0FBVSxFQUFFUCxHQUFZO0lBQzdERSxNQUFNTSxHQUFHLENBQUNKLEtBQUtHLE9BQU87UUFBRVA7SUFBSTtBQUM5QjtBQUVPLFNBQVNTLGlCQUFpQkMsTUFBYyxFQUFFQyxNQUEyQjtJQUMxRSxNQUFNQyxhQUFhQyxPQUFPQyxJQUFJLENBQUNILFFBQVFJLElBQUk7SUFDM0MsTUFBTUMsY0FBY0osV0FBV0ssR0FBRyxDQUFDYixDQUFBQSxNQUFPLENBQUMsRUFBRUEsSUFBSSxDQUFDLEVBQUVjLEtBQUtDLFNBQVMsQ0FBQ1IsTUFBTSxDQUFDUCxJQUFJLEVBQUUsQ0FBQyxFQUFFZ0IsSUFBSSxDQUFDO0lBQ3hGLE9BQU8sQ0FBQyxFQUFFVixPQUFPLENBQUMsRUFBRU0sWUFBWSxDQUFDO0FBQ25DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VjdWxhcl9odWIvLi9saWIvYWkvY2FjaGUudHM/NmVhNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMUlVDYWNoZSB9IGZyb20gJ2xydS1jYWNoZSc7XHJcblxyXG5jb25zdCBvcHRpb25zID0ge1xyXG4gIG1heDogMTAwLCAvLyBNYXhpbXVtIG51bWJlciBvZiBpdGVtcyBpbiB0aGUgY2FjaGVcclxuICB0dGw6IDEwMDAgKiA2MCAqIDYwLCAvLyAxIGhvdXIgZGVmYXVsdCBUVExcclxuICBhbGxvd1N0YWxlOiBmYWxzZSxcclxufTtcclxuXHJcbmNvbnN0IGNhY2hlID0gbmV3IExSVUNhY2hlPHN0cmluZywgYW55PihvcHRpb25zKTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYWNoZWQ8VD4oa2V5OiBzdHJpbmcpOiBUIHwgdW5kZWZpbmVkIHtcclxuICByZXR1cm4gY2FjaGUuZ2V0KGtleSkgYXMgVCB8IHVuZGVmaW5lZDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldENhY2hlZChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgdHRsPzogbnVtYmVyKSB7XHJcbiAgY2FjaGUuc2V0KGtleSwgdmFsdWUsIHsgdHRsIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVDYWNoZUtleShwcmVmaXg6IHN0cmluZywgcGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcclxuICBjb25zdCBzb3J0ZWRLZXlzID0gT2JqZWN0LmtleXMocGFyYW1zKS5zb3J0KCk7XHJcbiAgY29uc3QgcGFyYW1TdHJpbmcgPSBzb3J0ZWRLZXlzLm1hcChrZXkgPT4gYCR7a2V5fToke0pTT04uc3RyaW5naWZ5KHBhcmFtc1trZXldKX1gKS5qb2luKCd8Jyk7XHJcbiAgcmV0dXJuIGAke3ByZWZpeH18JHtwYXJhbVN0cmluZ31gO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJMUlVDYWNoZSIsIm9wdGlvbnMiLCJtYXgiLCJ0dGwiLCJhbGxvd1N0YWxlIiwiY2FjaGUiLCJnZXRDYWNoZWQiLCJrZXkiLCJnZXQiLCJzZXRDYWNoZWQiLCJ2YWx1ZSIsInNldCIsImdlbmVyYXRlQ2FjaGVLZXkiLCJwcmVmaXgiLCJwYXJhbXMiLCJzb3J0ZWRLZXlzIiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJwYXJhbVN0cmluZyIsIm1hcCIsIkpTT04iLCJzdHJpbmdpZnkiLCJqb2luIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/cache.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/client.ts":
/*!**************************!*\
  !*** ./lib/ai/client.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   client: () => (/* binding */ client),\n/* harmony export */   getCompletion: () => (/* binding */ getCompletion)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n\n// Check for Azure environment variables\nconst isAzure = !!process.env.AZURE_OPENAI_ENDPOINT;\nlet client;\nif (isAzure) {\n    if (!process.env.AZURE_OPENAI_KEY || !process.env.AZURE_OPENAI_ENDPOINT) {\n        console.warn(\"Azure OpenAI credentials missing. AI features may not work.\");\n    }\n    client = new openai__WEBPACK_IMPORTED_MODULE_0__.AzureOpenAI({\n        apiKey: process.env.AZURE_OPENAI_KEY,\n        endpoint: process.env.AZURE_OPENAI_ENDPOINT,\n        deployment: process.env.AZURE_OPENAI_DEPLOYMENT_NAME,\n        apiVersion: \"2024-05-01-preview\"\n    });\n} else {\n    if (!process.env.OPENAI_API_KEY) {\n        console.warn(\"OpenAI API Key missing. AI features may not work.\");\n    }\n    client = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n        apiKey: process.env.OPENAI_API_KEY\n    });\n}\nasync function getCompletion(messages, options = {}) {\n    try {\n        const deploymentName = process.env.AZURE_OPENAI_DEPLOYMENT_NAME || \"gpt-4\";\n        const response = await client.chat.completions.create({\n            model: isAzure ? deploymentName : \"gpt-4-turbo\",\n            messages,\n            temperature: options.temperature ?? 0.7,\n            max_tokens: options.max_tokens ?? 1000\n        });\n        return response.choices[0].message.content;\n    } catch (error) {\n        console.error(\"Error calling AI service:\", error);\n        throw error;\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvY2xpZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFxQztBQUNUO0FBTzVCLHdDQUF3QztBQUN4QyxNQUFNRSxVQUFVLENBQUMsQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUI7QUFFbkQsSUFBSUM7QUFFSixJQUFJSixTQUFTO0lBQ1gsSUFBSSxDQUFDQyxRQUFRQyxHQUFHLENBQUNHLGdCQUFnQixJQUFJLENBQUNKLFFBQVFDLEdBQUcsQ0FBQ0MscUJBQXFCLEVBQUU7UUFDdkVHLFFBQVFDLElBQUksQ0FBQztJQUNmO0lBQ0FILFNBQVMsSUFBSU4sK0NBQVdBLENBQUM7UUFDdkJVLFFBQVFQLFFBQVFDLEdBQUcsQ0FBQ0csZ0JBQWdCO1FBQ3BDSSxVQUFVUixRQUFRQyxHQUFHLENBQUNDLHFCQUFxQjtRQUMzQ08sWUFBWVQsUUFBUUMsR0FBRyxDQUFDUyw0QkFBNEI7UUFDcERDLFlBQVk7SUFDZDtBQUNGLE9BQU87SUFDTCxJQUFJLENBQUNYLFFBQVFDLEdBQUcsQ0FBQ1csY0FBYyxFQUFFO1FBQzdCUCxRQUFRQyxJQUFJLENBQUM7SUFDakI7SUFDQUgsU0FBUyxJQUFJTCw4Q0FBTUEsQ0FBQztRQUNsQlMsUUFBUVAsUUFBUUMsR0FBRyxDQUFDVyxjQUFjO0lBQ3BDO0FBQ0Y7QUFFTyxlQUFlQyxjQUNwQkMsUUFBOEQsRUFDOURDLFVBQTZCLENBQUMsQ0FBQztJQUUvQixJQUFJO1FBQ0YsTUFBTUMsaUJBQWlCaEIsUUFBUUMsR0FBRyxDQUFDUyw0QkFBNEIsSUFBSTtRQUVuRSxNQUFNTyxXQUFXLE1BQU1kLE9BQU9lLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxNQUFNLENBQUM7WUFDcERDLE9BQU90QixVQUFVaUIsaUJBQWlCO1lBQ2xDRjtZQUNBUSxhQUFhUCxRQUFRTyxXQUFXLElBQUk7WUFDcENDLFlBQVlSLFFBQVFRLFVBQVUsSUFBSTtRQUNwQztRQUVBLE9BQU9OLFNBQVNPLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ0MsT0FBTztJQUM1QyxFQUFFLE9BQU9DLE9BQU87UUFDZHRCLFFBQVFzQixLQUFLLENBQUMsNkJBQTZCQTtRQUMzQyxNQUFNQTtJQUNSO0FBQ0Y7QUFFa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWN1bGFyX2h1Yi8uL2xpYi9haS9jbGllbnQudHM/NzE4OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBenVyZU9wZW5BSSB9IGZyb20gJ29wZW5haSc7XHJcbmltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuXHJcbmludGVyZmFjZSBDb21wbGV0aW9uT3B0aW9ucyB7XHJcbiAgdGVtcGVyYXR1cmU/OiBudW1iZXI7XHJcbiAgbWF4X3Rva2Vucz86IG51bWJlcjtcclxufVxyXG5cclxuLy8gQ2hlY2sgZm9yIEF6dXJlIGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG5jb25zdCBpc0F6dXJlID0gISFwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfRU5EUE9JTlQ7XHJcblxyXG5sZXQgY2xpZW50OiBBenVyZU9wZW5BSSB8IE9wZW5BSTtcclxuXHJcbmlmIChpc0F6dXJlKSB7XHJcbiAgaWYgKCFwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfS0VZIHx8ICFwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfRU5EUE9JTlQpIHtcclxuICAgIGNvbnNvbGUud2FybignQXp1cmUgT3BlbkFJIGNyZWRlbnRpYWxzIG1pc3NpbmcuIEFJIGZlYXR1cmVzIG1heSBub3Qgd29yay4nKTtcclxuICB9XHJcbiAgY2xpZW50ID0gbmV3IEF6dXJlT3BlbkFJKHtcclxuICAgIGFwaUtleTogcHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0tFWSxcclxuICAgIGVuZHBvaW50OiBwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfRU5EUE9JTlQsXHJcbiAgICBkZXBsb3ltZW50OiBwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfREVQTE9ZTUVOVF9OQU1FLFxyXG4gICAgYXBpVmVyc2lvbjogJzIwMjQtMDUtMDEtcHJldmlldycsIC8vIERlZmF1bHQgdG8gYSByZWNlbnQgdmVyc2lvblxyXG4gIH0pO1xyXG59IGVsc2Uge1xyXG4gIGlmICghcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdPcGVuQUkgQVBJIEtleSBtaXNzaW5nLiBBSSBmZWF0dXJlcyBtYXkgbm90IHdvcmsuJyk7XHJcbiAgfVxyXG4gIGNsaWVudCA9IG5ldyBPcGVuQUkoe1xyXG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbXBsZXRpb24oXHJcbiAgbWVzc2FnZXM6IE9wZW5BSS5DaGF0LkNvbXBsZXRpb25zLkNoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtW10sXHJcbiAgb3B0aW9uczogQ29tcGxldGlvbk9wdGlvbnMgPSB7fVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVwbG95bWVudE5hbWUgPSBwcm9jZXNzLmVudi5BWlVSRV9PUEVOQUlfREVQTE9ZTUVOVF9OQU1FIHx8ICdncHQtNCc7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICBtb2RlbDogaXNBenVyZSA/IGRlcGxveW1lbnROYW1lIDogJ2dwdC00LXR1cmJvJywgLy8gTW9kZWwgaXMgaWdub3JlZCBieSBBenVyZSBjbGllbnQgaW4gZmF2b3Igb2YgZGVwbG95bWVudFxyXG4gICAgICBtZXNzYWdlcyxcclxuICAgICAgdGVtcGVyYXR1cmU6IG9wdGlvbnMudGVtcGVyYXR1cmUgPz8gMC43LFxyXG4gICAgICBtYXhfdG9rZW5zOiBvcHRpb25zLm1heF90b2tlbnMgPz8gMTAwMCxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsbGluZyBBSSBzZXJ2aWNlOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgY2xpZW50IH07XHJcbiJdLCJuYW1lcyI6WyJBenVyZU9wZW5BSSIsIk9wZW5BSSIsImlzQXp1cmUiLCJwcm9jZXNzIiwiZW52IiwiQVpVUkVfT1BFTkFJX0VORFBPSU5UIiwiY2xpZW50IiwiQVpVUkVfT1BFTkFJX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiYXBpS2V5IiwiZW5kcG9pbnQiLCJkZXBsb3ltZW50IiwiQVpVUkVfT1BFTkFJX0RFUExPWU1FTlRfTkFNRSIsImFwaVZlcnNpb24iLCJPUEVOQUlfQVBJX0tFWSIsImdldENvbXBsZXRpb24iLCJtZXNzYWdlcyIsIm9wdGlvbnMiLCJkZXBsb3ltZW50TmFtZSIsInJlc3BvbnNlIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJjaG9pY2VzIiwibWVzc2FnZSIsImNvbnRlbnQiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/client.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/parsers.ts":
/*!***************************!*\
  !*** ./lib/ai/parsers.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConsensusSummarySchema: () => (/* binding */ ConsensusSummarySchema),\n/* harmony export */   DeltaNarrativeSchema: () => (/* binding */ DeltaNarrativeSchema),\n/* harmony export */   QuerySchema: () => (/* binding */ QuerySchema),\n/* harmony export */   SentimentAnalysisSchema: () => (/* binding */ SentimentAnalysisSchema),\n/* harmony export */   parseAiResponse: () => (/* binding */ parseAiResponse)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n\nconst ConsensusSummarySchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    summary: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n    key_themes: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.string()),\n    dominant_view: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n    notable_outliers: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        institution: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        view: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n    })),\n    confidence: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"high\",\n        \"medium\",\n        \"low\"\n    ])\n});\nconst SentimentAnalysisSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    sentiment: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"bullish\",\n        \"bearish\",\n        \"neutral\",\n        \"mixed\"\n    ]),\n    confidence: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(1),\n    key_phrases: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.string())\n});\nconst DeltaNarrativeSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    narrative: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n    sections: zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        whats_new: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        whats_intensified: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        whats_faded: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        notable_reversals: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n    }),\n    key_shifts: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        theme: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        direction: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        driver: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n    }))\n});\nconst QuerySchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    answer: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n    sources: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        institution: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n        excerpt: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n    })),\n    follow_up_questions: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.string())\n});\n/**\r\n * Helper to parse JSON from AI response, handling markdown code blocks if present.\r\n */ function parseAiResponse(content, schema) {\n    if (!content) {\n        throw new Error(\"Empty AI response\");\n    }\n    let jsonString = content.trim();\n    // Strip markdown code blocks if present\n    if (jsonString.startsWith(\"```\")) {\n        const lines = jsonString.split(\"\\n\");\n        if (lines[0].startsWith(\"```\")) {\n            lines.shift(); // Remove first line\n        }\n        if (lines[lines.length - 1].startsWith(\"```\")) {\n            lines.pop(); // Remove last line\n        }\n        jsonString = lines.join(\"\\n\");\n    }\n    // Attempt to parse JSON\n    try {\n        const parsed = JSON.parse(jsonString);\n        return schema.parse(parsed);\n    } catch (error) {\n        console.error(\"Failed to parse AI response:\", content);\n        throw new Error(`Invalid structured output: ${error}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvcGFyc2Vycy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBd0I7QUFHakIsTUFBTUMseUJBQXlCRCx1Q0FBUSxDQUFDO0lBQzdDRyxTQUFTSCx1Q0FBUTtJQUNqQkssWUFBWUwsc0NBQU8sQ0FBQ0EsdUNBQVE7SUFDNUJPLGVBQWVQLHVDQUFRO0lBQ3ZCUSxrQkFBa0JSLHNDQUFPLENBQUNBLHVDQUFRLENBQUM7UUFDakNTLGFBQWFULHVDQUFRO1FBQ3JCVSxNQUFNVix1Q0FBUTtJQUNoQjtJQUNBVyxZQUFZWCx3Q0FBTSxDQUFDO1FBQUM7UUFBUTtRQUFVO0tBQU07QUFDOUMsR0FBRztBQUVJLE1BQU1hLDBCQUEwQmIsdUNBQVEsQ0FBQztJQUM5Q2MsV0FBV2Qsd0NBQU0sQ0FBQztRQUFDO1FBQVc7UUFBVztRQUFXO0tBQVE7SUFDNURXLFlBQVlYLHVDQUFRLEdBQUdnQixHQUFHLENBQUMsR0FBR0MsR0FBRyxDQUFDO0lBQ2xDQyxhQUFhbEIsc0NBQU8sQ0FBQ0EsdUNBQVE7QUFDL0IsR0FBRztBQUVJLE1BQU1tQix1QkFBdUJuQix1Q0FBUSxDQUFDO0lBQzNDb0IsV0FBV3BCLHVDQUFRO0lBQ25CcUIsVUFBVXJCLHVDQUFRLENBQUM7UUFDakJzQixXQUFXdEIsdUNBQVE7UUFDbkJ1QixtQkFBbUJ2Qix1Q0FBUTtRQUMzQndCLGFBQWF4Qix1Q0FBUTtRQUNyQnlCLG1CQUFtQnpCLHVDQUFRO0lBQzdCO0lBQ0EwQixZQUFZMUIsc0NBQU8sQ0FBQ0EsdUNBQVEsQ0FBQztRQUMzQjJCLE9BQU8zQix1Q0FBUTtRQUNmNEIsV0FBVzVCLHVDQUFRO1FBQ25CNkIsUUFBUTdCLHVDQUFRO0lBQ2xCO0FBQ0YsR0FBRztBQUVJLE1BQU04QixjQUFjOUIsdUNBQVEsQ0FBQztJQUNsQytCLFFBQVEvQix1Q0FBUTtJQUNoQmdDLFNBQVNoQyxzQ0FBTyxDQUFDQSx1Q0FBUSxDQUFDO1FBQ3hCaUMsSUFBSWpDLHVDQUFRO1FBQ1pTLGFBQWFULHVDQUFRO1FBQ3JCa0MsU0FBU2xDLHVDQUFRO0lBQ25CO0lBQ0FtQyxxQkFBcUJuQyxzQ0FBTyxDQUFDQSx1Q0FBUTtBQUN2QyxHQUFHO0FBRUg7O0NBRUMsR0FDTSxTQUFTb0MsZ0JBQW1CQyxPQUFrQyxFQUFFQyxNQUFvQjtJQUN6RixJQUFJLENBQUNELFNBQVM7UUFDWixNQUFNLElBQUlFLE1BQU07SUFDbEI7SUFFQSxJQUFJQyxhQUFhSCxRQUFRSSxJQUFJO0lBRTdCLHdDQUF3QztJQUN4QyxJQUFJRCxXQUFXRSxVQUFVLENBQUMsUUFBUTtRQUNoQyxNQUFNQyxRQUFRSCxXQUFXSSxLQUFLLENBQUM7UUFDL0IsSUFBSUQsS0FBSyxDQUFDLEVBQUUsQ0FBQ0QsVUFBVSxDQUFDLFFBQVE7WUFDOUJDLE1BQU1FLEtBQUssSUFBSSxvQkFBb0I7UUFDckM7UUFDQSxJQUFJRixLQUFLLENBQUNBLE1BQU1HLE1BQU0sR0FBRyxFQUFFLENBQUNKLFVBQVUsQ0FBQyxRQUFRO1lBQzdDQyxNQUFNSSxHQUFHLElBQUksbUJBQW1CO1FBQ2xDO1FBQ0FQLGFBQWFHLE1BQU1LLElBQUksQ0FBQztJQUMxQjtJQUVBLHdCQUF3QjtJQUN4QixJQUFJO1FBQ0YsTUFBTUMsU0FBU0MsS0FBS0MsS0FBSyxDQUFDWDtRQUMxQixPQUFPRixPQUFPYSxLQUFLLENBQUNGO0lBQ3RCLEVBQUUsT0FBT0csT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsZ0NBQWdDZjtRQUM5QyxNQUFNLElBQUlFLE1BQU0sQ0FBQywyQkFBMkIsRUFBRWEsTUFBTSxDQUFDO0lBQ3ZEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWN1bGFyX2h1Yi8uL2xpYi9haS9wYXJzZXJzLnRzPzhmMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XHJcbmltcG9ydCB7IENvbnNlbnN1c1N1bW1hcnlPdXRwdXQsIFNlbnRpbWVudEFuYWx5c2lzT3V0cHV0LCBEZWx0YU5hcnJhdGl2ZU91dHB1dCwgUXVlcnlPdXRwdXQgfSBmcm9tICdAL3R5cGVzL2FpJztcclxuXHJcbmV4cG9ydCBjb25zdCBDb25zZW5zdXNTdW1tYXJ5U2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIHN1bW1hcnk6IHouc3RyaW5nKCksXHJcbiAga2V5X3RoZW1lczogei5hcnJheSh6LnN0cmluZygpKSxcclxuICBkb21pbmFudF92aWV3OiB6LnN0cmluZygpLFxyXG4gIG5vdGFibGVfb3V0bGllcnM6IHouYXJyYXkoei5vYmplY3Qoe1xyXG4gICAgaW5zdGl0dXRpb246IHouc3RyaW5nKCksXHJcbiAgICB2aWV3OiB6LnN0cmluZygpLFxyXG4gIH0pKSxcclxuICBjb25maWRlbmNlOiB6LmVudW0oWydoaWdoJywgJ21lZGl1bScsICdsb3cnXSksXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IFNlbnRpbWVudEFuYWx5c2lzU2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIHNlbnRpbWVudDogei5lbnVtKFsnYnVsbGlzaCcsICdiZWFyaXNoJywgJ25ldXRyYWwnLCAnbWl4ZWQnXSksXHJcbiAgY29uZmlkZW5jZTogei5udW1iZXIoKS5taW4oMCkubWF4KDEpLFxyXG4gIGtleV9waHJhc2VzOiB6LmFycmF5KHouc3RyaW5nKCkpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBEZWx0YU5hcnJhdGl2ZVNjaGVtYSA9IHoub2JqZWN0KHtcclxuICBuYXJyYXRpdmU6IHouc3RyaW5nKCksXHJcbiAgc2VjdGlvbnM6IHoub2JqZWN0KHtcclxuICAgIHdoYXRzX25ldzogei5zdHJpbmcoKSxcclxuICAgIHdoYXRzX2ludGVuc2lmaWVkOiB6LnN0cmluZygpLFxyXG4gICAgd2hhdHNfZmFkZWQ6IHouc3RyaW5nKCksXHJcbiAgICBub3RhYmxlX3JldmVyc2Fsczogei5zdHJpbmcoKSxcclxuICB9KSxcclxuICBrZXlfc2hpZnRzOiB6LmFycmF5KHoub2JqZWN0KHtcclxuICAgIHRoZW1lOiB6LnN0cmluZygpLFxyXG4gICAgZGlyZWN0aW9uOiB6LnN0cmluZygpLFxyXG4gICAgZHJpdmVyOiB6LnN0cmluZygpLFxyXG4gIH0pKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgUXVlcnlTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgYW5zd2VyOiB6LnN0cmluZygpLFxyXG4gIHNvdXJjZXM6IHouYXJyYXkoei5vYmplY3Qoe1xyXG4gICAgaWQ6IHouc3RyaW5nKCksXHJcbiAgICBpbnN0aXR1dGlvbjogei5zdHJpbmcoKSxcclxuICAgIGV4Y2VycHQ6IHouc3RyaW5nKCksXHJcbiAgfSkpLFxyXG4gIGZvbGxvd191cF9xdWVzdGlvbnM6IHouYXJyYXkoei5zdHJpbmcoKSksXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEhlbHBlciB0byBwYXJzZSBKU09OIGZyb20gQUkgcmVzcG9uc2UsIGhhbmRsaW5nIG1hcmtkb3duIGNvZGUgYmxvY2tzIGlmIHByZXNlbnQuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VBaVJlc3BvbnNlPFQ+KGNvbnRlbnQ6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQsIHNjaGVtYTogei5ab2RUeXBlPFQ+KTogVCB7XHJcbiAgaWYgKCFjb250ZW50KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0VtcHR5IEFJIHJlc3BvbnNlJyk7XHJcbiAgfVxyXG5cclxuICBsZXQganNvblN0cmluZyA9IGNvbnRlbnQudHJpbSgpO1xyXG5cclxuICAvLyBTdHJpcCBtYXJrZG93biBjb2RlIGJsb2NrcyBpZiBwcmVzZW50XHJcbiAgaWYgKGpzb25TdHJpbmcuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgIGNvbnN0IGxpbmVzID0ganNvblN0cmluZy5zcGxpdCgnXFxuJyk7XHJcbiAgICBpZiAobGluZXNbMF0uc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgbGluZXMuc2hpZnQoKTsgLy8gUmVtb3ZlIGZpcnN0IGxpbmVcclxuICAgIH1cclxuICAgIGlmIChsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICBsaW5lcy5wb3AoKTsgLy8gUmVtb3ZlIGxhc3QgbGluZVxyXG4gICAgfVxyXG4gICAganNvblN0cmluZyA9IGxpbmVzLmpvaW4oJ1xcbicpO1xyXG4gIH1cclxuICBcclxuICAvLyBBdHRlbXB0IHRvIHBhcnNlIEpTT05cclxuICB0cnkge1xyXG4gICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcclxuICAgIHJldHVybiBzY2hlbWEucGFyc2UocGFyc2VkKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIHJlc3BvbnNlOicsIGNvbnRlbnQpO1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0cnVjdHVyZWQgb3V0cHV0OiAke2Vycm9yfWApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsieiIsIkNvbnNlbnN1c1N1bW1hcnlTY2hlbWEiLCJvYmplY3QiLCJzdW1tYXJ5Iiwic3RyaW5nIiwia2V5X3RoZW1lcyIsImFycmF5IiwiZG9taW5hbnRfdmlldyIsIm5vdGFibGVfb3V0bGllcnMiLCJpbnN0aXR1dGlvbiIsInZpZXciLCJjb25maWRlbmNlIiwiZW51bSIsIlNlbnRpbWVudEFuYWx5c2lzU2NoZW1hIiwic2VudGltZW50IiwibnVtYmVyIiwibWluIiwibWF4Iiwia2V5X3BocmFzZXMiLCJEZWx0YU5hcnJhdGl2ZVNjaGVtYSIsIm5hcnJhdGl2ZSIsInNlY3Rpb25zIiwid2hhdHNfbmV3Iiwid2hhdHNfaW50ZW5zaWZpZWQiLCJ3aGF0c19mYWRlZCIsIm5vdGFibGVfcmV2ZXJzYWxzIiwia2V5X3NoaWZ0cyIsInRoZW1lIiwiZGlyZWN0aW9uIiwiZHJpdmVyIiwiUXVlcnlTY2hlbWEiLCJhbnN3ZXIiLCJzb3VyY2VzIiwiaWQiLCJleGNlcnB0IiwiZm9sbG93X3VwX3F1ZXN0aW9ucyIsInBhcnNlQWlSZXNwb25zZSIsImNvbnRlbnQiLCJzY2hlbWEiLCJFcnJvciIsImpzb25TdHJpbmciLCJ0cmltIiwic3RhcnRzV2l0aCIsImxpbmVzIiwic3BsaXQiLCJzaGlmdCIsImxlbmd0aCIsInBvcCIsImpvaW4iLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/parsers.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/prompts.ts":
/*!***************************!*\
  !*** ./lib/ai/prompts.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadPrompt: () => (/* binding */ loadPrompt)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst PROMPTS_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"prompts\");\nasync function loadPrompt(templateName, variables) {\n    const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(PROMPTS_DIR, `${templateName}.md`);\n    try {\n        let content = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath, \"utf-8\");\n        // Replace {{variable}} placeholders\n        for (const [key, value] of Object.entries(variables)){\n            const placeholder = new RegExp(`{{${key}}}`, \"g\");\n            // Handle array/object variables by pretty-printing them\n            const replacement = typeof value === \"object\" ? JSON.stringify(value, null, 2) : String(value);\n            content = content.replace(placeholder, replacement);\n        }\n        return content;\n    } catch (error) {\n        console.error(`Error loading prompt template: ${templateName}`, error);\n        throw new Error(`Failed to load prompt template: ${templateName}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvcHJvbXB0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE2QjtBQUNMO0FBRXhCLE1BQU1FLGNBQWNELGdEQUFTLENBQUNHLFFBQVFDLEdBQUcsSUFBSTtBQUV0QyxlQUFlQyxXQUFXQyxZQUFvQixFQUFFQyxTQUE4QjtJQUNuRixNQUFNQyxXQUFXUixnREFBUyxDQUFDQyxhQUFhLENBQUMsRUFBRUssYUFBYSxHQUFHLENBQUM7SUFFNUQsSUFBSTtRQUNGLElBQUlHLFVBQVUsTUFBTVYsMkRBQVcsQ0FBQ1MsVUFBVTtRQUUxQyxvQ0FBb0M7UUFDcEMsS0FBSyxNQUFNLENBQUNHLEtBQUtDLE1BQU0sSUFBSUMsT0FBT0MsT0FBTyxDQUFDUCxXQUFZO1lBQ3BELE1BQU1RLGNBQWMsSUFBSUMsT0FBTyxDQUFDLEVBQUUsRUFBRUwsSUFBSSxFQUFFLENBQUMsRUFBRTtZQUU3Qyx3REFBd0Q7WUFDeEQsTUFBTU0sY0FBYyxPQUFPTCxVQUFVLFdBQ2pDTSxLQUFLQyxTQUFTLENBQUNQLE9BQU8sTUFBTSxLQUM1QlEsT0FBT1I7WUFFWEgsVUFBVUEsUUFBUVksT0FBTyxDQUFDTixhQUFhRTtRQUN6QztRQUVBLE9BQU9SO0lBQ1QsRUFBRSxPQUFPYSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxDQUFDLCtCQUErQixFQUFFaEIsYUFBYSxDQUFDLEVBQUVnQjtRQUNoRSxNQUFNLElBQUlFLE1BQU0sQ0FBQyxnQ0FBZ0MsRUFBRWxCLGFBQWEsQ0FBQztJQUNuRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VjdWxhcl9odWIvLi9saWIvYWkvcHJvbXB0cy50cz9jM2EzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5cclxuY29uc3QgUFJPTVBUU19ESVIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3Byb21wdHMnKTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkUHJvbXB0KHRlbXBsYXRlTmFtZTogc3RyaW5nLCB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKFBST01QVFNfRElSLCBgJHt0ZW1wbGF0ZU5hbWV9Lm1kYCk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGxldCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGYtOCcpO1xyXG4gICAgXHJcbiAgICAvLyBSZXBsYWNlIHt7dmFyaWFibGV9fSBwbGFjZWhvbGRlcnNcclxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHZhcmlhYmxlcykpIHtcclxuICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBuZXcgUmVnRXhwKGB7eyR7a2V5fX19YCwgJ2cnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEhhbmRsZSBhcnJheS9vYmplY3QgdmFyaWFibGVzIGJ5IHByZXR0eS1wcmludGluZyB0aGVtXHJcbiAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcclxuICAgICAgICA/IEpTT04uc3RyaW5naWZ5KHZhbHVlLCBudWxsLCAyKSBcclxuICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XHJcbiAgICAgICAgXHJcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UocGxhY2Vob2xkZXIsIHJlcGxhY2VtZW50KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGNvbnRlbnQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGxvYWRpbmcgcHJvbXB0IHRlbXBsYXRlOiAke3RlbXBsYXRlTmFtZX1gLCBlcnJvcik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkIHByb21wdCB0ZW1wbGF0ZTogJHt0ZW1wbGF0ZU5hbWV9YCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJQUk9NUFRTX0RJUiIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwibG9hZFByb21wdCIsInRlbXBsYXRlTmFtZSIsInZhcmlhYmxlcyIsImZpbGVQYXRoIiwiY29udGVudCIsInJlYWRGaWxlIiwia2V5IiwidmFsdWUiLCJPYmplY3QiLCJlbnRyaWVzIiwicGxhY2Vob2xkZXIiLCJSZWdFeHAiLCJyZXBsYWNlbWVudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJTdHJpbmciLCJyZXBsYWNlIiwiZXJyb3IiLCJjb25zb2xlIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/prompts.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/client.ts":
/*!**************************!*\
  !*** ./lib/db/client.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = global;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"query\"\n    ]\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvY2xpZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyxrQkFBa0JDO0FBRWpCLE1BQU1DLFNBQ1hGLGdCQUFnQkUsTUFBTSxJQUN0QixJQUFJSCx3REFBWUEsQ0FBQztJQUNmSSxLQUFLO1FBQUM7S0FBUTtBQUNoQixHQUFHO0FBRUwsSUFBSUMsSUFBeUIsRUFBY0osZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VjdWxhcl9odWIvLi9saWIvZGIvY2xpZW50LnRzP2ZkZWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBwcmlzbWE6IFByaXNtYUNsaWVudCB9O1xyXG5cclxuZXhwb3J0IGNvbnN0IHByaXNtYSA9XHJcbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fFxyXG4gIG5ldyBQcmlzbWFDbGllbnQoe1xyXG4gICAgbG9nOiBbJ3F1ZXJ5J10sXHJcbiAgfSk7XHJcblxyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYTtcclxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbCIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/client.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/queries.ts":
/*!***************************!*\
  !*** ./lib/db/queries.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCompareStats: () => (/* binding */ getCompareStats),\n/* harmony export */   getOutlookById: () => (/* binding */ getOutlookById),\n/* harmony export */   getOutlooks: () => (/* binding */ getOutlooks),\n/* harmony export */   getStats: () => (/* binding */ getStats)\n/* harmony export */ });\n/* harmony import */ var _client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./client */ \"(rsc)/./lib/db/client.ts\");\n\nasync function getOutlooks(filter) {\n    const { year, institution, theme, themeCategory, conviction, limit = 50, page = 1, search } = filter;\n    const skip = (page - 1) * limit;\n    const where = {};\n    if (year) where.year = year;\n    if (institution) where.institution = {\n        contains: institution\n    }; // Flexible search\n    if (theme) where.theme = {\n        contains: theme\n    };\n    if (themeCategory) where.themeCategory = themeCategory;\n    if (conviction) where.convictionTier = conviction;\n    if (search) {\n        where.OR = [\n            {\n                callText: {\n                    contains: search\n                }\n            },\n            {\n                theme: {\n                    contains: search\n                }\n            },\n            {\n                institution: {\n                    contains: search\n                }\n            }\n        ];\n    }\n    const [data, total] = await Promise.all([\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.findMany({\n            where,\n            take: limit,\n            skip,\n            orderBy: {\n                id: \"asc\"\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.count({\n            where\n        })\n    ]);\n    return {\n        data,\n        total,\n        page,\n        limit\n    };\n}\nasync function getOutlookById(id) {\n    return _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.findUnique({\n        where: {\n            id\n        }\n    });\n}\nasync function getStats() {\n    const [total, years, themes, institutions] = await Promise.all([\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.count(),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"year\"\n            ],\n            _count: {\n                _all: true\n            },\n            orderBy: {\n                year: \"desc\"\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"themeCategory\"\n            ],\n            _count: {\n                _all: true\n            },\n            // @ts-ignore: Prisma orderBy syntax for aggregated groups can be tricky in TS\n            orderBy: {\n                _count: {\n                    _all: \"desc\"\n                }\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"institutionCanonical\"\n            ],\n            _count: {\n                _all: true\n            },\n            // @ts-ignore\n            orderBy: {\n                _count: {\n                    _all: \"desc\"\n                }\n            }\n        })\n    ]);\n    return {\n        total_records: Number(total),\n        // @ts-ignore: _count property existence\n        years: years.map((y)=>({\n                year: y.year,\n                count: Number(y._count?._all || 0)\n            })),\n        // @ts-ignore\n        themes: themes.map((t)=>({\n                theme: t.themeCategory,\n                count: Number(t._count?._all || 0)\n            })),\n        // @ts-ignore\n        institutions: institutions.map((i)=>({\n                institution: i.institutionCanonical,\n                count: Number(i._count?._all || 0)\n            }))\n    };\n}\nasync function getCompareStats(year1, year2) {\n    const [y1Themes, y2Themes, y1Inst, y2Inst] = await Promise.all([\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"themeCategory\"\n            ],\n            where: {\n                year: year1\n            },\n            _count: {\n                _all: true\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"themeCategory\"\n            ],\n            where: {\n                year: year2\n            },\n            _count: {\n                _all: true\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"institutionCanonical\",\n                \"themeCategory\"\n            ],\n            where: {\n                year: year1\n            }\n        }),\n        _client__WEBPACK_IMPORTED_MODULE_0__.prisma.outlookCall.groupBy({\n            by: [\n                \"institutionCanonical\",\n                \"themeCategory\"\n            ],\n            where: {\n                year: year2\n            }\n        })\n    ]);\n    // Process Themes\n    // @ts-ignore\n    const themes1Map = new Map(y1Themes.map((t)=>[\n            t.themeCategory,\n            t._count?._all || 0\n        ]));\n    // @ts-ignore\n    const themes2Map = new Map(y2Themes.map((t)=>[\n            t.themeCategory,\n            t._count?._all || 0\n        ]));\n    // @ts-ignore: Set iteration downlevel handled by tsconfig\n    const allThemes = new Set([\n        ...themes1Map.keys(),\n        ...themes2Map.keys()\n    ]);\n    const themes_emerged = [];\n    const themes_extinct = [];\n    const themes_grew = [];\n    const themes_declined = [];\n    allThemes.forEach((theme)=>{\n        const c1 = themes1Map.get(theme) || 0;\n        const c2 = themes2Map.get(theme) || 0;\n        const delta = c2 - c1;\n        if (c1 === 0 && c2 > 0) themes_emerged.push(theme);\n        else if (c1 > 0 && c2 === 0) themes_extinct.push(theme);\n        else if (delta > 0) themes_grew.push({\n            theme,\n            delta\n        });\n        else if (delta < 0) themes_declined.push({\n            theme,\n            delta\n        });\n    });\n    // Process Institutions (Change in themes covered)\n    // This is complex, simplification:\n    // For each institution, list themes in Y1 vs Y2\n    const instMap1 = new Map();\n    y1Inst.forEach((i)=>{\n        const list = instMap1.get(i.institutionCanonical) || [];\n        list.push(i.themeCategory);\n        instMap1.set(i.institutionCanonical, list);\n    });\n    const instMap2 = new Map();\n    y2Inst.forEach((i)=>{\n        const list = instMap2.get(i.institutionCanonical) || [];\n        list.push(i.themeCategory);\n        instMap2.set(i.institutionCanonical, list);\n    });\n    const institutional_changes = [];\n    const allInst = new Set([\n        ...instMap1.keys(),\n        ...instMap2.keys()\n    ]);\n    for (const inst of allInst){\n        const t1 = instMap1.get(inst) || [];\n        const t2 = instMap2.get(inst) || [];\n        // Only include if there's a change or significant data\n        institutional_changes.push({\n            institution: inst,\n            year1_themes: t1,\n            year2_themes: t2\n        });\n    }\n    return {\n        year1,\n        year2,\n        themes_emerged,\n        themes_extinct,\n        themes_grew: themes_grew.sort((a, b)=>b.delta - a.delta),\n        themes_declined: themes_declined.sort((a, b)=>a.delta - b.delta),\n        institutional_changes: institutional_changes.slice(0, 50) // Limit to top 50 to avoid massive payload\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUFBYTtRQUN6QjZELFNBQVNFLEdBQUcsQ0FBQzNCLEVBQUVDLG9CQUFvQixFQUFFeUI7SUFDdkM7SUFFQSxNQUFNRSxXQUFXLElBQUlsQjtJQUNyQkYsT0FBT1csT0FBTyxDQUFDbkIsQ0FBQUE7UUFDYixNQUFNMEIsT0FBT0UsU0FBU1AsR0FBRyxDQUFDckIsRUFBRUMsb0JBQW9CLEtBQUssRUFBRTtRQUN2RHlCLEtBQUtGLElBQUksQ0FBQ3hCLEVBQUVwQyxhQUFhO1FBQ3pCZ0UsU0FBU0QsR0FBRyxDQUFDM0IsRUFBRUMsb0JBQW9CLEVBQUV5QjtJQUN2QztJQUVBLE1BQU1HLHdCQUF3QixFQUFFO0lBQ2hDLE1BQU1DLFVBQVUsSUFBSWpCLElBQUk7V0FBSVksU0FBU1gsSUFBSTtXQUFPYyxTQUFTZCxJQUFJO0tBQUc7SUFFaEUsS0FBSyxNQUFNaUIsUUFBUUQsUUFBUztRQUMxQixNQUFNRSxLQUFLUCxTQUFTSixHQUFHLENBQUNVLFNBQVMsRUFBRTtRQUNuQyxNQUFNRSxLQUFLTCxTQUFTUCxHQUFHLENBQUNVLFNBQVMsRUFBRTtRQUNuQyx1REFBdUQ7UUFDdkRGLHNCQUFzQkwsSUFBSSxDQUFDO1lBQ3pCOUQsYUFBYXFFO1lBQ2JHLGNBQWNGO1lBQ2RHLGNBQWNGO1FBQ2hCO0lBQ0Y7SUFFQSxPQUFPO1FBQ0w5QjtRQUNBQztRQUNBVztRQUNBQztRQUNBQyxhQUFhQSxZQUFZbUIsSUFBSSxDQUFDLENBQUNDLEdBQUVDLElBQU1BLEVBQUVmLEtBQUssR0FBR2MsRUFBRWQsS0FBSztRQUN4REwsaUJBQWlCQSxnQkFBZ0JrQixJQUFJLENBQUMsQ0FBQ0MsR0FBRUMsSUFBTUQsRUFBRWQsS0FBSyxHQUFHZSxFQUFFZixLQUFLO1FBQ2hFTSx1QkFBdUJBLHNCQUFzQlUsS0FBSyxDQUFDLEdBQUcsSUFBSSwyQ0FBMkM7SUFDdkc7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlY3VsYXJfaHViLy4vbGliL2RiL3F1ZXJpZXMudHM/MmQ3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL2NsaWVudCc7XHJcbmltcG9ydCB7IE91dGxvb2tDYWxsLCBQcmlzbWEgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcblxyXG5leHBvcnQgdHlwZSBPdXRsb29rRmlsdGVyID0ge1xyXG4gIHllYXI/OiBudW1iZXI7XHJcbiAgaW5zdGl0dXRpb24/OiBzdHJpbmc7XHJcbiAgdGhlbWU/OiBzdHJpbmc7XHJcbiAgdGhlbWVDYXRlZ29yeT86IHN0cmluZztcclxuICBjb252aWN0aW9uPzogc3RyaW5nO1xyXG4gIGxpbWl0PzogbnVtYmVyO1xyXG4gIHBhZ2U/OiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG59O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE91dGxvb2tzKGZpbHRlcjogT3V0bG9va0ZpbHRlcikge1xyXG4gIGNvbnN0IHsgeWVhciwgaW5zdGl0dXRpb24sIHRoZW1lLCB0aGVtZUNhdGVnb3J5LCBjb252aWN0aW9uLCBsaW1pdCA9IDUwLCBwYWdlID0gMSwgc2VhcmNoIH0gPSBmaWx0ZXI7XHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBsaW1pdDtcclxuXHJcbiAgY29uc3Qgd2hlcmU6IFByaXNtYS5PdXRsb29rQ2FsbFdoZXJlSW5wdXQgPSB7fTtcclxuXHJcbiAgaWYgKHllYXIpIHdoZXJlLnllYXIgPSB5ZWFyO1xyXG4gIGlmIChpbnN0aXR1dGlvbikgd2hlcmUuaW5zdGl0dXRpb24gPSB7IGNvbnRhaW5zOiBpbnN0aXR1dGlvbiB9OyAvLyBGbGV4aWJsZSBzZWFyY2hcclxuICBpZiAodGhlbWUpIHdoZXJlLnRoZW1lID0geyBjb250YWluczogdGhlbWUgfTtcclxuICBpZiAodGhlbWVDYXRlZ29yeSkgd2hlcmUudGhlbWVDYXRlZ29yeSA9IHRoZW1lQ2F0ZWdvcnk7XHJcbiAgaWYgKGNvbnZpY3Rpb24pIHdoZXJlLmNvbnZpY3Rpb25UaWVyID0gY29udmljdGlvbjtcclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgeyBjYWxsVGV4dDogeyBjb250YWluczogc2VhcmNoIH0gfSxcclxuICAgICAgeyB0aGVtZTogeyBjb250YWluczogc2VhcmNoIH0gfSxcclxuICAgICAgeyBpbnN0aXR1dGlvbjogeyBjb250YWluczogc2VhcmNoIH0gfSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBjb25zdCBbZGF0YSwgdG90YWxdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgcHJpc21hLm91dGxvb2tDYWxsLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIHRha2U6IGxpbWl0LFxyXG4gICAgICBza2lwLFxyXG4gICAgICBvcmRlckJ5OiB7IGlkOiAnYXNjJyB9LCAvLyBTdGFibGUgb3JkZXJpbmdcclxuICAgIH0pLFxyXG4gICAgcHJpc21hLm91dGxvb2tDYWxsLmNvdW50KHsgd2hlcmUgfSksXHJcbiAgXSk7XHJcblxyXG4gIHJldHVybiB7IGRhdGEsIHRvdGFsLCBwYWdlLCBsaW1pdCB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3V0bG9va0J5SWQoaWQ6IHN0cmluZykge1xyXG4gIHJldHVybiBwcmlzbWEub3V0bG9va0NhbGwuZmluZFVuaXF1ZSh7XHJcbiAgICB3aGVyZTogeyBpZCB9LFxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3RhdHMoKSB7XHJcbiAgY29uc3QgW3RvdGFsLCB5ZWFycywgdGhlbWVzLCBpbnN0aXR1dGlvbnNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgcHJpc21hLm91dGxvb2tDYWxsLmNvdW50KCksXHJcbiAgICBwcmlzbWEub3V0bG9va0NhbGwuZ3JvdXBCeSh7XHJcbiAgICAgIGJ5OiBbJ3llYXInXSxcclxuICAgICAgX2NvdW50OiB7IF9hbGw6IHRydWUgfSxcclxuICAgICAgb3JkZXJCeTogeyB5ZWFyOiAnZGVzYycgfSxcclxuICAgIH0pLFxyXG4gICAgcHJpc21hLm91dGxvb2tDYWxsLmdyb3VwQnkoe1xyXG4gICAgICBieTogWyd0aGVtZUNhdGVnb3J5J10sXHJcbiAgICAgIF9jb3VudDogeyBfYWxsOiB0cnVlIH0sXHJcbiAgICAgIC8vIEB0cy1pZ25vcmU6IFByaXNtYSBvcmRlckJ5IHN5bnRheCBmb3IgYWdncmVnYXRlZCBncm91cHMgY2FuIGJlIHRyaWNreSBpbiBUU1xyXG4gICAgICBvcmRlckJ5OiB7IF9jb3VudDogeyBfYWxsOiAnZGVzYycgfSB9LFxyXG4gICAgfSksXHJcbiAgICBwcmlzbWEub3V0bG9va0NhbGwuZ3JvdXBCeSh7XHJcbiAgICAgIGJ5OiBbJ2luc3RpdHV0aW9uQ2Fub25pY2FsJ10sXHJcbiAgICAgIF9jb3VudDogeyBfYWxsOiB0cnVlIH0sXHJcbiAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgb3JkZXJCeTogeyBfY291bnQ6IHsgX2FsbDogJ2Rlc2MnIH0gfSxcclxuICAgIH0pLFxyXG4gIF0pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgdG90YWxfcmVjb3JkczogTnVtYmVyKHRvdGFsKSxcclxuICAgIC8vIEB0cy1pZ25vcmU6IF9jb3VudCBwcm9wZXJ0eSBleGlzdGVuY2VcclxuICAgIHllYXJzOiB5ZWFycy5tYXAoeSA9PiAoeyB5ZWFyOiB5LnllYXIsIGNvdW50OiBOdW1iZXIoeS5fY291bnQ/Ll9hbGwgfHwgMCkgfSkpLFxyXG4gICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgdGhlbWVzOiB0aGVtZXMubWFwKHQgPT4gKHsgdGhlbWU6IHQudGhlbWVDYXRlZ29yeSwgY291bnQ6IE51bWJlcih0Ll9jb3VudD8uX2FsbCB8fCAwKSB9KSksXHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICBpbnN0aXR1dGlvbnM6IGluc3RpdHV0aW9ucy5tYXAoaSA9PiAoeyBpbnN0aXR1dGlvbjogaS5pbnN0aXR1dGlvbkNhbm9uaWNhbCwgY291bnQ6IE51bWJlcihpLl9jb3VudD8uX2FsbCB8fCAwKSB9KSksXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbXBhcmVTdGF0cyh5ZWFyMTogbnVtYmVyLCB5ZWFyMjogbnVtYmVyKSB7XHJcbiAgY29uc3QgW3kxVGhlbWVzLCB5MlRoZW1lcywgeTFJbnN0LCB5Mkluc3RdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgIHByaXNtYS5vdXRsb29rQ2FsbC5ncm91cEJ5KHtcclxuICAgICAgIGJ5OiBbJ3RoZW1lQ2F0ZWdvcnknXSxcclxuICAgICAgIHdoZXJlOiB7IHllYXI6IHllYXIxIH0sXHJcbiAgICAgICBfY291bnQ6IHsgX2FsbDogdHJ1ZSB9LFxyXG4gICAgIH0pLFxyXG4gICAgIHByaXNtYS5vdXRsb29rQ2FsbC5ncm91cEJ5KHtcclxuICAgICAgIGJ5OiBbJ3RoZW1lQ2F0ZWdvcnknXSxcclxuICAgICAgIHdoZXJlOiB7IHllYXI6IHllYXIyIH0sXHJcbiAgICAgICBfY291bnQ6IHsgX2FsbDogdHJ1ZSB9LFxyXG4gICAgIH0pLFxyXG4gICAgIHByaXNtYS5vdXRsb29rQ2FsbC5ncm91cEJ5KHtcclxuICAgICAgIGJ5OiBbJ2luc3RpdHV0aW9uQ2Fub25pY2FsJywgJ3RoZW1lQ2F0ZWdvcnknXSxcclxuICAgICAgIHdoZXJlOiB7IHllYXI6IHllYXIxIH0sXHJcbiAgICAgfSksXHJcbiAgICAgcHJpc21hLm91dGxvb2tDYWxsLmdyb3VwQnkoe1xyXG4gICAgICAgYnk6IFsnaW5zdGl0dXRpb25DYW5vbmljYWwnLCAndGhlbWVDYXRlZ29yeSddLFxyXG4gICAgICAgd2hlcmU6IHsgeWVhcjogeWVhcjIgfSxcclxuICAgICB9KSxcclxuICBdKTtcclxuXHJcbiAgLy8gUHJvY2VzcyBUaGVtZXNcclxuICAvLyBAdHMtaWdub3JlXHJcbiAgY29uc3QgdGhlbWVzMU1hcCA9IG5ldyBNYXAoeTFUaGVtZXMubWFwKHQgPT4gW3QudGhlbWVDYXRlZ29yeSwgdC5fY291bnQ/Ll9hbGwgfHwgMF0pKTtcclxuICAvLyBAdHMtaWdub3JlXHJcbiAgY29uc3QgdGhlbWVzMk1hcCA9IG5ldyBNYXAoeTJUaGVtZXMubWFwKHQgPT4gW3QudGhlbWVDYXRlZ29yeSwgdC5fY291bnQ/Ll9hbGwgfHwgMF0pKTtcclxuICBcclxuICAvLyBAdHMtaWdub3JlOiBTZXQgaXRlcmF0aW9uIGRvd25sZXZlbCBoYW5kbGVkIGJ5IHRzY29uZmlnXHJcbiAgY29uc3QgYWxsVGhlbWVzID0gbmV3IFNldChbLi4udGhlbWVzMU1hcC5rZXlzKCksIC4uLnRoZW1lczJNYXAua2V5cygpXSk7XHJcbiAgY29uc3QgdGhlbWVzX2VtZXJnZWQ6IHN0cmluZ1tdID0gW107XHJcbiAgY29uc3QgdGhlbWVzX2V4dGluY3Q6IHN0cmluZ1tdID0gW107XHJcbiAgY29uc3QgdGhlbWVzX2dyZXc6IHsgdGhlbWU6IHN0cmluZzsgZGVsdGE6IG51bWJlciB9W10gPSBbXTtcclxuICBjb25zdCB0aGVtZXNfZGVjbGluZWQ6IHsgdGhlbWU6IHN0cmluZzsgZGVsdGE6IG51bWJlciB9W10gPSBbXTtcclxuXHJcbiAgYWxsVGhlbWVzLmZvckVhY2godGhlbWUgPT4ge1xyXG4gICAgY29uc3QgYzEgPSB0aGVtZXMxTWFwLmdldCh0aGVtZSkgfHwgMDtcclxuICAgIGNvbnN0IGMyID0gdGhlbWVzMk1hcC5nZXQodGhlbWUpIHx8IDA7XHJcbiAgICBjb25zdCBkZWx0YSA9IGMyIC0gYzE7XHJcblxyXG4gICAgaWYgKGMxID09PSAwICYmIGMyID4gMCkgdGhlbWVzX2VtZXJnZWQucHVzaCh0aGVtZSk7XHJcbiAgICBlbHNlIGlmIChjMSA+IDAgJiYgYzIgPT09IDApIHRoZW1lc19leHRpbmN0LnB1c2godGhlbWUpO1xyXG4gICAgZWxzZSBpZiAoZGVsdGEgPiAwKSB0aGVtZXNfZ3Jldy5wdXNoKHsgdGhlbWUsIGRlbHRhIH0pO1xyXG4gICAgZWxzZSBpZiAoZGVsdGEgPCAwKSB0aGVtZXNfZGVjbGluZWQucHVzaCh7IHRoZW1lLCBkZWx0YSB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gUHJvY2VzcyBJbnN0aXR1dGlvbnMgKENoYW5nZSBpbiB0aGVtZXMgY292ZXJlZClcclxuICAvLyBUaGlzIGlzIGNvbXBsZXgsIHNpbXBsaWZpY2F0aW9uOlxyXG4gIC8vIEZvciBlYWNoIGluc3RpdHV0aW9uLCBsaXN0IHRoZW1lcyBpbiBZMSB2cyBZMlxyXG4gIGNvbnN0IGluc3RNYXAxID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZ1tdPigpO1xyXG4gIHkxSW5zdC5mb3JFYWNoKGkgPT4ge1xyXG4gICAgY29uc3QgbGlzdCA9IGluc3RNYXAxLmdldChpLmluc3RpdHV0aW9uQ2Fub25pY2FsKSB8fCBbXTtcclxuICAgIGxpc3QucHVzaChpLnRoZW1lQ2F0ZWdvcnkpO1xyXG4gICAgaW5zdE1hcDEuc2V0KGkuaW5zdGl0dXRpb25DYW5vbmljYWwsIGxpc3QpO1xyXG4gIH0pO1xyXG4gIFxyXG4gIGNvbnN0IGluc3RNYXAyID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZ1tdPigpO1xyXG4gIHkySW5zdC5mb3JFYWNoKGkgPT4ge1xyXG4gICAgY29uc3QgbGlzdCA9IGluc3RNYXAyLmdldChpLmluc3RpdHV0aW9uQ2Fub25pY2FsKSB8fCBbXTtcclxuICAgIGxpc3QucHVzaChpLnRoZW1lQ2F0ZWdvcnkpO1xyXG4gICAgaW5zdE1hcDIuc2V0KGkuaW5zdGl0dXRpb25DYW5vbmljYWwsIGxpc3QpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBpbnN0aXR1dGlvbmFsX2NoYW5nZXMgPSBbXTtcclxuICBjb25zdCBhbGxJbnN0ID0gbmV3IFNldChbLi4uaW5zdE1hcDEua2V5cygpLCAuLi5pbnN0TWFwMi5rZXlzKCldKTtcclxuICBcclxuICBmb3IgKGNvbnN0IGluc3Qgb2YgYWxsSW5zdCkge1xyXG4gICAgY29uc3QgdDEgPSBpbnN0TWFwMS5nZXQoaW5zdCkgfHwgW107XHJcbiAgICBjb25zdCB0MiA9IGluc3RNYXAyLmdldChpbnN0KSB8fCBbXTtcclxuICAgIC8vIE9ubHkgaW5jbHVkZSBpZiB0aGVyZSdzIGEgY2hhbmdlIG9yIHNpZ25pZmljYW50IGRhdGFcclxuICAgIGluc3RpdHV0aW9uYWxfY2hhbmdlcy5wdXNoKHtcclxuICAgICAgaW5zdGl0dXRpb246IGluc3QsXHJcbiAgICAgIHllYXIxX3RoZW1lczogdDEsXHJcbiAgICAgIHllYXIyX3RoZW1lczogdDIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB5ZWFyMSxcclxuICAgIHllYXIyLFxyXG4gICAgdGhlbWVzX2VtZXJnZWQsXHJcbiAgICB0aGVtZXNfZXh0aW5jdCxcclxuICAgIHRoZW1lc19ncmV3OiB0aGVtZXNfZ3Jldy5zb3J0KChhLGIpID0+IGIuZGVsdGEgLSBhLmRlbHRhKSxcclxuICAgIHRoZW1lc19kZWNsaW5lZDogdGhlbWVzX2RlY2xpbmVkLnNvcnQoKGEsYikgPT4gYS5kZWx0YSAtIGIuZGVsdGEpLFxyXG4gICAgaW5zdGl0dXRpb25hbF9jaGFuZ2VzOiBpbnN0aXR1dGlvbmFsX2NoYW5nZXMuc2xpY2UoMCwgNTApIC8vIExpbWl0IHRvIHRvcCA1MCB0byBhdm9pZCBtYXNzaXZlIHBheWxvYWRcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJnZXRPdXRsb29rcyIsImZpbHRlciIsInllYXIiLCJpbnN0aXR1dGlvbiIsInRoZW1lIiwidGhlbWVDYXRlZ29yeSIsImNvbnZpY3Rpb24iLCJsaW1pdCIsInBhZ2UiLCJzZWFyY2giLCJza2lwIiwid2hlcmUiLCJjb250YWlucyIsImNvbnZpY3Rpb25UaWVyIiwiT1IiLCJjYWxsVGV4dCIsImRhdGEiLCJ0b3RhbCIsIlByb21pc2UiLCJhbGwiLCJvdXRsb29rQ2FsbCIsImZpbmRNYW55IiwidGFrZSIsIm9yZGVyQnkiLCJpZCIsImNvdW50IiwiZ2V0T3V0bG9va0J5SWQiLCJmaW5kVW5pcXVlIiwiZ2V0U3RhdHMiLCJ5ZWFycyIsInRoZW1lcyIsImluc3RpdHV0aW9ucyIsImdyb3VwQnkiLCJieSIsIl9jb3VudCIsIl9hbGwiLCJ0b3RhbF9yZWNvcmRzIiwiTnVtYmVyIiwibWFwIiwieSIsInQiLCJpIiwiaW5zdGl0dXRpb25DYW5vbmljYWwiLCJnZXRDb21wYXJlU3RhdHMiLCJ5ZWFyMSIsInllYXIyIiwieTFUaGVtZXMiLCJ5MlRoZW1lcyIsInkxSW5zdCIsInkySW5zdCIsInRoZW1lczFNYXAiLCJNYXAiLCJ0aGVtZXMyTWFwIiwiYWxsVGhlbWVzIiwiU2V0Iiwia2V5cyIsInRoZW1lc19lbWVyZ2VkIiwidGhlbWVzX2V4dGluY3QiLCJ0aGVtZXNfZ3JldyIsInRoZW1lc19kZWNsaW5lZCIsImZvckVhY2giLCJjMSIsImdldCIsImMyIiwiZGVsdGEiLCJwdXNoIiwiaW5zdE1hcDEiLCJsaXN0Iiwic2V0IiwiaW5zdE1hcDIiLCJpbnN0aXR1dGlvbmFsX2NoYW5nZXMiLCJhbGxJbnN0IiwiaW5zdCIsInQxIiwidDIiLCJ5ZWFyMV90aGVtZXMiLCJ5ZWFyMl90aGVtZXMiLCJzb3J0IiwiYSIsImIiLCJzbGljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/queries.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/openai","vendor-chunks/zod","vendor-chunks/lru-cache"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fdelta%2Froute&page=%2Fapi%2Fai%2Fdelta%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fdelta%2Froute.ts&appDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5C1%20Projects%5Csecular_forum%5Csecular_hub&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();